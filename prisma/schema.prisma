// Prisma Schema for Haber Sitesi
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Admin kullanicilari
model Admin {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String
  name      String
  role      String   @default("editor")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Kategoriler
model Kategori {
  id        Int      @id @default(autoincrement())
  isim      String
  slug      String   @unique
  renk      String   @default("#dc2626")
  aciklama  String?
  sira      Int      @default(0)
  aktif     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  haberler  Haber[]
}

// Yazarlar
model Yazar {
  id        Int      @id @default(autoincrement())
  isim      String
  slug      String   @unique
  email     String?
  biyografi String?
  foto      String?
  twitter   String?
  aktif     Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  haberler  Haber[]
}

// Etiketler
model Etiket {
  id        Int      @id @default(autoincrement())
  isim      String
  slug      String   @unique
  createdAt DateTime @default(now())
  haberler  HaberEtiket[]
}

// Haberler
model Haber {
  id              Int           @id @default(autoincrement())
  baslik          String
  slug            String        @unique
  spot            String?
  icerik          String?       @db.Text
  kapakResmi      String?
  kategoriId      Int?
  kategori        Kategori?     @relation(fields: [kategoriId], references: [id])
  yazarId         Int?
  yazar           Yazar?        @relation(fields: [yazarId], references: [id])
  etiketler       HaberEtiket[]
  durum           String        @default("taslak")
  manset          Boolean       @default(false)
  mansetSira      Int?
  sondakika       Boolean       @default(false)
  okunmaSayisi    Int           @default(0)
  newsKeywords    String?
  seoTitle        String?
  seoDescription  String?
  yayinTarihi     DateTime      @default(now())
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt
  yorumlar        Yorum[]
}

// Haber-Etiket iliski tablosu
model HaberEtiket {
  haberId   Int
  etiketId  Int
  haber     Haber   @relation(fields: [haberId], references: [id], onDelete: Cascade)
  etiket    Etiket  @relation(fields: [etiketId], references: [id], onDelete: Cascade)
  
  @@id([haberId, etiketId])
}

// Yorumlar
model Yorum {
  id           Int      @id @default(autoincrement())
  icerik       String
  haberId      Int
  haber        Haber    @relation(fields: [haberId], references: [id], onDelete: Cascade)
  yazarAdi     String
  yazarEmail   String?
  durum        String   @default("beklemede")
  begeniSayisi Int      @default(0)
  createdAt    DateTime @default(now())
}

// Site Ayarlari (tek kayit)
model SiteAyarlari {
  id           Int      @id @default(1)
  siteAdi      String   @default("Haber Sitesi")
  siteAciklama String?
  logo         String?
  favicon      String?
  email        String?
  telefon      String?
  adres        String?
  facebook     String?
  twitter      String?
  instagram    String?
  youtube      String?
  footerText   String?
  updatedAt    DateTime @updatedAt
}
